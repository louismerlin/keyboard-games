<!DOCTYPE html>
<html>

<head>
    <title>Welcome to Vue</title>
    <script src="https://unpkg.com/vue/dist/vue.js"></script>
</head>
<style>
    body {
        font-family: "medium", Helvetica, sans-serif;
        background-color: black;
    }

    h1 {
        font-size: 100px;
        text-align: center;
        color: #00a9e0;
    }
    
    p {
      text-align: center;
      color: white;
    }
</style>

<body>
    <div id="app">
        <h1 v-on:keyup="sendKey">
          SWAGBOARD
        </h1>
        <p>{{ message }}</p>
    </div>

    <script>
        function get(theUrl, callback) {
            var xmlHttp = new XMLHttpRequest();
            xmlHttp.onreadystatechange = function() {
                if (xmlHttp.readyState == 4 && xmlHttp.status == 200)
                    callback(xmlHttp.responseText);
            }
            xmlHttp.open("GET", theUrl, true); // true for asynchronous
            xmlHttp.send(null);
        }

        function post(url, data, callback) {
            var xmlHttp = new XMLHttpRequest();
            xmlHttp.onreadystatechange = function() {
                if (xmlHttp.readyState == 4 && xmlHttp.status == 200)
                    callback(xmlHttp.responseText);
            }
            xmlHttp.open("POST", url, true);
            xmlHttp.setRequestHeader("Content-Type", "application/json");
            xmlHttp.send(data);
        }

        var app = new Vue({
            el: '#app',
            data: {
                greeting: 'Want to play a game ?',
            },
            methods: {
                getGreetings: function() {
                    get("http://localhost:5000", function(status) {
                        if (status == 1) {
                          app.message = "Congrats player 1 !!";
                          app.color = red;
                        }
                        if (status == 2) {
                          app.message = "Congrats player 2 !!";
                          app.color = green;
                        }
                        if (status == 0) {
                          app.message = "That's a tie";
                        }
                    })
                },
                sendKey: function(e) {
                    post("http://localhost:5000/key", JSON.stringify({
                        k: e.key
                    }), function(e) {
                        //console.log(e);
                    })
                }
            },
            created() {
                setInterval(function() {
                    app.getGreetings();
                }, 1000 / 1);
                addEventListener("keyup", function(e) {
                    app.sendKey(e)
                });
            }
        })
    </script>
</body>

</html>
